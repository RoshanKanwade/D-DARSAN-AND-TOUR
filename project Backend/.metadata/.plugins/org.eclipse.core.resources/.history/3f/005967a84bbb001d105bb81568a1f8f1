package com.app.service;

import javax.transaction.Transactional;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.security.crypto.password.PasswordEncoder;
import org.springframework.stereotype.Service;

import com.app.dto.RegisteredDto;
import com.app.exceptionhHandling.UsernameNotFoundException;
import com.app.pojos.RegistrationDetail;
import com.app.pojos.User;
import com.app.repository.RegistrationRepository;
@Service 
@Transactional
public class RegistrationServiceImpl implements RegisterService{
@Autowired
private RegistrationRepository registerRepo;

@Autowired
private PasswordEncoder enc;
	@Override
	public boolean RegisterUser(RegisteredDto dto) {
		
		return false;
	}

	
	public RegistrationDetail findByMobileNo(RegisteredDto dto)  { 
		
		RegistrationDetail user = registerRepo.findBymobileNum(Double.parseDouble(dto.getMobileNo()));
		System.out.println(user);
		if(user==null) {
	        return user;
		}
	        RegistrationDetail  Registerdetail= new RegistrationDetail(0,dto.getEmail(),Double.parseDouble(dto.getMobileNo()),dto.getPassword(), "User");
			User user1= new User(dto.getUserName());
			 Registerdetail.setUser(user1);
			 user1.setRegistration(Registerdetail);
			 
			            
		return registerRepo.save(Registerdetail);
	}

	@Override
	public void save(RegisteredDto dto) {
		System.out.println("dvbhj"+enc.encode(dto.getPassword()));
		 RegistrationDetail  Registerdetail= new RegistrationDetail(0,dto.getEmail(),Double.parseDouble(dto.getMobileNo()),enc.encode(dto.getPassword()), "User");
		User user= new User(dto.getUserName());
		
		
			
		
		 Registerdetail.setUser(user);
		 user.setRegistration(Registerdetail);
		 
		 registerRepo.save(Registerdetail);
		
	}
 
}
